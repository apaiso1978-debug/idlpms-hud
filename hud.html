<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>E-OS HUD | Platform Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="assets/css/theme.css?v=2.4" />
    <link rel="stylesheet" href="assets/css/components.css?v=2.4" />
    <link rel="stylesheet" href="assets/css/styles.css?v=2.4" />
    <link rel="stylesheet" href="assets/css/notifications.css?v=2.4" />
    <link rel="stylesheet" href="assets/css/submenu.css?v=2.4" />
    <link rel="stylesheet" href="assets/css/timeline_menu.css?v=3.2" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#22d3ee" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <script src="assets/js/data.js?v=2.7"></script>
    <script src="assets/js/secrets.local.js"></script>
    <!-- HLS.js for DLTV video playback (Global) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hls.js/1.6.5/hls.min.js"></script>
    <!-- Core Services -->
    <script src="src/services/DataService.js?v=2.6"></script>
    <script src="src/services/InsForgeDataService.js?v=2.6"></script>
    <script src="src/services/CacheService.js?v=2.6"></script>
    <script src="src/services/SyncEngine.js?v=2.6"></script>
    <script src="src/services/AuthService.js?v=2.6"></script>
    <script src="src/services/AppBootstrap.js?v=2.6"></script>

    <!-- Modular Learning Engines -->
    <script src="src/lib/AIAuditor.js"></script>
    <script src="src/engines/DNAHarvester.js"></script>
    <script src="src/engines/QuizEngine.js"></script>
    <script src="src/engines/SecurityEngine.js"></script>

    <script src="assets/js/task_system.js"></script>
    <script src="assets/js/components/eos_calendar.js"></script>
    <script src="assets/js/delegation_panel.js?v=3.2"></script>
    <script src="assets/js/app.js?v=3.2"></script>
</head>

<body
    class="bg-[var(--vs-bg-deep)] text-[var(--vs-text-body)] overflow-hidden font-['Sarabun'] antialiased select-none">
    <div class="flex h-screen overflow-hidden border border-[var(--vs-border)]">
        <!-- Activity Bar (Icons Only) -->
        <aside class="vs-activity-bar z-50">
            <!-- E-OS Isometric Symmetrical Box Logo (Clickable) -->
            <a href="index.html" title="View System Telemetry"
                class="h-[48px] flex items-center justify-center cursor-pointer hover:opacity-80 transition-opacity"
                style="color: var(--vs-accent);">
                <svg viewBox="0 0 24 24" fill="none" class="w-7 h-7 drop-shadow-[0_0_8px_rgba(34,211,238,0.5)]"
                    stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="12.00,13.00 18.93,17.00 12.00,21.00 5.07,17.00" stroke-dasharray="1 2"
                        stroke-opacity="0.2" />
                    <polygon points="12.00,5.00 18.93,9.00 12.00,13.00 5.07,9.00" stroke-dasharray="1 2"
                        stroke-opacity="0.2" />
                    <path
                        d="M 12.00,13.00 L 12.00,5.00 M 18.93,17.00 L 18.93,9.00 M 12.00,21.00 L 12.00,13.00 M 5.07,17.00 L 5.07,9.00"
                        stroke-dasharray="1 2" stroke-opacity="0.2" />
                    <polygon
                        points="5.07,17.00 12.00,21.00 12.00,19.40 6.46,16.20 6.46,14.60 10.61,17.00 10.61,15.40 6.46,13.00 6.46,11.40 12.00,14.60 12.00,13.00 5.07,9.00"
                        stroke-opacity="0.3" />
                    <polygon
                        points="12.00,13.00 18.93,17.00 18.93,15.40 13.39,12.20 13.39,10.60 17.54,13.00 17.54,11.40 13.39,9.00 13.39,7.40 18.93,10.60 18.93,9.00 12.00,5.00" />
                    <path
                        d="M 12.00,13.00 L 5.07,17.00 M 18.93,17.00 L 12.00,21.00 M 18.93,15.40 L 12.00,19.40 M 13.39,12.20 L 6.46,16.20 M 13.39,10.60 L 6.46,14.60 M 17.54,13.00 L 10.61,17.00 M 17.54,11.40 L 10.61,15.40 M 13.39,9.00 L 6.46,13.00 M 13.39,7.40 L 6.46,11.40 M 18.93,10.60 L 12.00,14.60 M 18.93,9.00 L 12.00,13.00 M 12.00,5.00 L 5.07,9.00"
                        stroke-opacity="0.6" />
                </svg>
            </a>
            <div class="flex-1 flex flex-col">
                <div class="activity-item active" data-tooltip="‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" data-view="explorer">
                    <i class="icon i-folder h-6 w-6"></i>
                    <div id="badge-explorer" class="vs-badge"></div>
                </div>
                <div class="activity-item" data-tooltip="‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏´‡∏•‡∏±‡∏Å" data-view="manage">
                    <i class="icon i-squares h-6 w-6"></i>
                    <div id="badge-manage" class="vs-badge"></div>
                </div>
                <div class="activity-item" data-tooltip="‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" data-view="manual">
                    <i class="icon i-book h-6 w-6"></i>
                    <div id="badge-manual" class="vs-badge"></div>
                </div>
                <div class="activity-item" data-tooltip="‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£" data-view="chat">
                    <i class="icon i-chat h-6 w-6"></i>
                    <div id="badge-chat" class="vs-badge"></div>
                </div>
                <div class="activity-item" data-tooltip="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏∞‡∏ö‡∏ö" data-view="search">
                    <i class="icon i-search h-6 w-6"></i>
                </div>
            </div>
            <div class="mt-auto flex flex-col pb-2">
                <div class="activity-item" data-tooltip="‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤" data-view="settings">
                    <i class="icon i-cog h-6 w-6"></i>
                </div>
            </div>
        </aside>

        <!-- Sidebar Panel -->
        <aside id="side-panel" class="vs-side-bar relative overflow-hidden">
            <!-- Explorer View -->
            <div id="panel-explorer" class="vs-sidebar-panel flex flex-col h-full">
                <div class="vs-panel-header uppercase font-light text-[13px] text-[var(--vs-text-muted)] Thai-Rule">
                    <span>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤</span>
                    <i class="icon i-dots h-3 w-3"></i>
                </div>

                <!-- Explorer Menu Items -->
                <div class="px-1 py-1 space-y-2 mt-1">
                    <div class="timeline-menu-container">
                        <button class="timeline-parent-item active" data-page="pages/home.html"
                            data-name="Dashboard Overview">
                            <i class="icon i-squares text-cyan-400 group-hover:scale-110 transition-transform"></i>
                            <span style="color: var(--vs-text-title) !important;"
                                class="font-light">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</span>
                        </button>
                    </div>

                    <div class="timeline-menu-container">
                        <button class="timeline-parent-item" data-page="pages/schedule.html" data-name="Class Schedule">
                            <i class="icon i-calendar text-emerald-400 group-hover:scale-110 transition-transform"></i>
                            <span style="color: var(--vs-text-title) !important;"
                                class="font-light">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£</span>
                        </button>
                    </div>

                    <div class="timeline-menu-container">
                        <button class="timeline-parent-item" data-page="pages/dashboard_admin.html"
                            data-name="Admin Dashboard">
                            <i class="icon i-chart text-fuchsia-400 group-hover:scale-110 transition-transform"></i>
                            <span style="color: var(--vs-text-title) !important;" class="font-light">Dashboard
                                ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</span>
                        </button>
                    </div>

                    <div class="timeline-menu-container">
                        <button class="timeline-parent-item" data-page="pages/admin/dashboard.html"
                            data-name="System Telemetry">
                            <i class="icon i-cpu text-amber-400 group-hover:scale-110 transition-transform"></i>
                            <span style="color: var(--vs-text-title) !important;"
                                class="font-light">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏£‡∏∞‡∏ö‡∏ö</span>
                        </button>
                    </div>

                    <div class="timeline-menu-container">
                        <button class="timeline-parent-item" data-page="pages/subject_cards.html"
                            data-name="Subject Matrix">
                            <i class="icon i-book text-pink-400 group-hover:scale-110 transition-transform"></i>
                            <span style="color: var(--vs-text-title) !important;"
                                class="font-light">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</span>
                        </button>
                    </div>

                    <!-- Phase 17: Gamified Transparency Ledger -->
                    <div class="timeline-menu-container">
                        <button class="timeline-parent-item" data-page="pages/transparency_board.html"
                            data-name="Transparency Ledger">
                            <i class="icon i-eye text-emerald-400 group-hover:scale-110 transition-transform"></i>
                            <span style="color: var(--vs-text-title) !important;"
                                class="font-light">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</span>
                        </button>
                    </div>

                    <!-- Separator & New Section: Content Engineering (Admin/Dev) -->
                    <div id="content-engineering-section" style="display: none;">
                        <div class="pt-4 pb-2 px-3">
                            <div
                                class="text-[10px] font-bold tracking-wider text-[var(--vs-text-muted)] uppercase Thai-Rule">
                                Content Engineering</div>
                        </div>

                        <!-- Harvester Progress Tracker -->
                        <div class="timeline-menu-container">
                            <button class="timeline-parent-item" data-page="pages/content_pipeline.html"
                                data-name="Content Harvester Engine">
                                <i
                                    class="icon i-academic-cap text-cyan-400 group-hover:scale-110 transition-transform"></i>
                                <span style="color: var(--vs-text-title) !important;" class="font-light">‡∏™‡∏Å‡∏±‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
                                    DLTV & 7-Steps</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="flex-1 flex flex-col items-center justify-center p-6 text-center opacity-20">
                    <i class="icon i-finger-print h-12 w-12 mb-4"></i>
                    <div class="hud-badge-micro uppercase Thai-Rule">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                    <div class="text-[13px] mt-2 font-mono uppercase">Unified Intelligence Matrix v1.0</div>
                </div>
            </div>

            <div id="panel-manual" class="vs-sidebar-panel flex flex-col h-full hidden">
                <div class="vs-panel-header uppercase font-light text-[13px] text-[var(--vs-text-muted)] Thai-Rule">
                    <span>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</span>
                    <i class="icon i-dots h-3 w-3"></i>
                </div>

                <div class="flex-1 overflow-y-auto px-1 py-1 space-y-2 mt-1">
                    <!-- Group 1: ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö (Collapsible) -->
                    <div class="timeline-menu-container">
                        <button class="timeline-parent-item collapsed menu-has-children"
                            data-toggle="manual-system-children">
                            <i class="icon i-book text-amber-400"></i>
                            <span style="color: var(--vs-text-title) !important;" class="font-light">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö</span>
                            <i class="icon i-chevron-right timeline-chevron"></i>
                        </button>
                        <div class="timeline-children-container collapsed" id="manual-system-children">
                            <button class="timeline-child-item active" data-page="pages/manual/vision.html"
                                data-name="1. ‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå / ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå">
                                <div class="timeline-node"></div>
                                <i class="icon i-eye"></i>
                                <span>1. ‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå / ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/roles.html"
                                data-name="2. ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á">
                                <div class="timeline-node"></div>
                                <i class="icon i-users"></i>
                                <span>2. ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/communication.html"
                                data-name="3. ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£">
                                <div class="timeline-node"></div>
                                <i class="icon i-chat"></i>
                                <span>3. ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/learning.html"
                                data-name="4. ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ">
                                <div class="timeline-node"></div>
                                <i class="icon i-lightning"></i>
                                <span>4. ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/database.html"
                                data-name="5. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                                <div class="timeline-node"></div>
                                <i class="icon i-database"></i>
                                <span>5. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/architecture.html"
                                data-name="6. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö">
                                <div class="timeline-node"></div>
                                <i class="icon i-cube"></i>
                                <span>6. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/files.html"
                                data-name="7. ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå">
                                <div class="timeline-node"></div>
                                <i class="icon i-folder"></i>
                                <span>7. ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/design.html"
                                data-name="8. ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö">
                                <div class="timeline-node"></div>
                                <i class="icon i-eye"></i>
                                <span>8. ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/offline.html"
                                data-name="9. ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå">
                                <div class="timeline-node"></div>
                                <i class="icon i-shield"></i>
                                <span>9. ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/data-service.html"
                                data-name="10. ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞ API">
                                <div class="timeline-node"></div>
                                <i class="icon i-database"></i>
                                <span>10. ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞ API</span>
                            </button>
                            <button class="timeline-child-item" data-page="pages/manual/infrastructure.html"
                                data-name="11. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô">
                                <div class="timeline-node"></div>
                                <i class="icon i-brand-github"></i>
                                <span>11. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</span>
                            </button>
                        </div>
                    </div>

                    <!-- Group 2: ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ Home school -->
                    <div class="timeline-menu-container">
                        <button class="timeline-child-item collapsed" data-page="pages/manual/homeschool.html"
                            data-name="‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ Home school">
                            <div class="timeline-node" style="border-color: transparent"></div>
                            <i class="icon i-home text-rose-400"></i>
                            <span style="color: var(--vs-text-title) !important;" class="font-light">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ Home
                                school</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Init Script for Manual Accordion -->
            <script>
                document.addEventListener('DOMContentLoaded', () => {
                    setTimeout(() => {
                        const manualPanel = document.getElementById('panel-manual');
                        if (manualPanel && window.TimelineMenu) {
                            const containers = manualPanel.querySelectorAll('.timeline-menu-container');
                            containers.forEach((c, idx) => {
                                // Provide a unique ID if not present
                                if (!c.id) c.id = 'manual-tl-group-' + idx;
                                window.TimelineMenu._attachEventListeners(c, {}, c.id);
                            });
                        }
                    }, 500);
                });
            </script>

            <!-- Management / Mission Control Panel -->
            <div id="panel-manage" class="vs-sidebar-panel flex flex-col h-full hidden">
                <div class="vs-panel-header uppercase font-light text-[13px] text-[var(--vs-text-muted)] Thai-Rule">
                    <span>‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</span>
                    <i class="icon i-dots h-3 w-3"></i>
                </div>
                <div class="h-full flex flex-col overflow-y-auto px-1 py-1 space-y-2 mt-1 pb-[100px]"
                    id="management-content">
                    <!-- Timeline groups rendered dynamically by ManagementEngine.renderDashboard() -->
                </div>
            </div>

            <!-- Chat View -->
            <div id="panel-chat" class="vs-sidebar-panel flex flex-col h-full hidden">
                <div class="vs-panel-header uppercase font-light text-[13px] text-[var(--vs-text-muted)] Thai-Rule">
                    <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</span>
                    <i class="icon i-dots h-3 w-3"></i>
                </div>
                <div class="flex-1 overflow-y-auto px-1 py-1 space-y-1 mt-1" id="chatList">
                    <!-- Dynamic Chat List -->
                    <div class="px-3 py-2 text-[var(--vs-text-muted)] text-[13px] uppercase Thai-Rule">
                        ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£...
                    </div>
                </div>
            </div>

            <div id="panel-search" class="vs-sidebar-panel flex flex-col h-full hidden">
                <div class="vs-panel-header uppercase font-light text-[13px] text-[var(--vs-text-muted)] Thai-Rule">
                    <span>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                    <i class="icon i-search h-3 w-3"></i>
                </div>
                <div class="px-1 py-1 mt-1">
                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•..."
                        class="w-full bg-[var(--vs-bg-deep)] border border-[var(--vs-border)] rounded-[var(--vs-radius)] px-3 py-2 text-[13px] text-[var(--vs-text-body)] focus:outline-none focus:border-[var(--vs-accent)] Thai-Rule" />
                </div>
            </div>

            <div id="panel-settings" class="vs-sidebar-panel flex flex-col h-full hidden">
                <div class="vs-panel-header uppercase font-light text-[13px] text-[var(--vs-text-muted)] Thai-Rule">
                    <span>‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</span>
                    <i class="icon i-dots h-3 w-3"></i>
                </div>
                <div class="px-0 py-1 space-y-4 mt-1">
                    <div class="px-3 text-[13px] text-[var(--vs-text-muted)] uppercase font-light Thai-Rule">
                        ‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö
                    </div>
                    <div class="space-y-1 px-1" id="role-switcher-list">
                        <!-- Role Buttons -->
                        <button onclick="switchRole('MOE_001')"
                            class="w-full vs-menu-item text-left px-3 py-2 rounded-[var(--vs-radius)] text-[13px] text-[var(--vs-text-body)] transition-all flex items-center justify-between group">
                            <span>‡∏ó‡πà‡∏≤‡∏ô‡∏£‡∏±‡∏ê‡∏°‡∏ô‡∏ï‡∏£‡∏µ (MOE)</span>
                            <i
                                class="icon i-globe h-3 w-3 opacity-0 group-hover:opacity-100 text-[var(--vs-accent)]"></i>
                        </button>
                        <button onclick="switchRole('OBEC_001')"
                            class="w-full vs-menu-item text-left px-3 py-2 rounded-[var(--vs-radius)] text-[13px] text-[var(--vs-text-body)] transition-all flex items-center justify-between group">
                            <span>‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏≤‡∏Ø ‡∏™‡∏û‡∏ê. (OBEC)</span>
                            <i
                                class="icon i-library h-3 w-3 opacity-0 group-hover:opacity-100 text-[var(--vs-accent)]"></i>
                        </button>
                        <button onclick="switchRole('ESA_DIR_001')"
                            class="w-full vs-menu-item text-left px-3 py-2 rounded-[var(--vs-radius)] text-[13px] text-[var(--vs-text-body)] transition-all flex items-center justify-between group">
                            <span>‡∏î‡∏£.‡∏™‡∏°‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ (‡∏ú‡∏≠.‡πÄ‡∏Ç‡∏ï 1)</span>
                            <i
                                class="icon i-building h-3 w-3 opacity-0 group-hover:opacity-100 text-[var(--vs-accent)]"></i>
                        </button>
                        <button onclick="switchRole('SCH_DIR_001')"
                            class="w-full vs-menu-item text-left px-3 py-2 rounded-[var(--vs-radius)] text-[13px] text-[var(--vs-text-body)] transition-all flex items-center justify-between group">
                            <span>‡∏ú‡∏≠.‡∏õ‡∏£‡∏µ‡∏ä‡∏≤ (‡∏ú‡∏≠.‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)</span>
                            <i
                                class="icon i-office h-3 w-3 opacity-0 group-hover:opacity-100 text-[var(--vs-accent)]"></i>
                        </button>
                        <button onclick="switchRole('TEA_001')"
                            class="w-full vs-menu-item text-left px-3 py-2 rounded-[var(--vs-radius)] text-[13px] text-[var(--vs-text-body)] transition-all flex items-center justify-between group">
                            <span>‡∏Ñ‡∏£‡∏π‡∏™‡∏≤‡∏¢‡∏ö‡∏±‡∏ß (‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô)</span>
                            <i
                                class="icon i-academic h-3 w-3 opacity-0 group-hover:opacity-100 text-[var(--vs-accent)]"></i>
                        </button>
                        <button onclick="switchRole('STU_001')"
                            class="w-full vs-menu-item text-left px-3 py-2 rounded-[var(--vs-radius)] text-[13px] text-[var(--vs-text-body)] transition-all flex items-center justify-between group font-light">
                            <span>‡∏≠‡∏±‡∏Ñ‡∏£‡∏û‡∏• (‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 6/1)</span>
                            <i
                                class="icon i-user h-3 w-3 opacity-0 group-hover:opacity-100 text-[var(--vs-accent)]"></i>
                        </button>
                        <button onclick="switchRole('PAR_001')"
                            class="w-full vs-menu-item text-left px-3 py-2 rounded-[var(--vs-radius)] text-[13px] text-[var(--vs-text-body)] transition-all flex items-center justify-between group">
                            <span>‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏û‡∏• (‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á)</span>
                            <i
                                class="icon i-users h-3 w-3 opacity-0 group-hover:opacity-100 text-[var(--vs-accent)]"></i>
                        </button>
                    </div>

                    <div class="pt-4 border-t border-[var(--vs-border)] mb-4">
                        <div class="px-3 text-[13px] text-[var(--vs-text-muted)] uppercase font-light mb-2 mt-1">
                            ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
                        </div>
                        <div class="px-3 flex items-center justify-between text-[13px] text-[var(--vs-text-body)] mb-2">
                            <span>‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö</span>
                            <span class="text-[var(--vs-accent)] uppercase">‡∏°‡∏≤‡∏ï‡∏£‡∏ß‡∏±‡∏î‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Profile (Bottom) -->
            <div class="nav-item vs-menu-item mt-auto border-t border-[var(--vs-border)] px-4 py-4 bg-[var(--vs-bg-card)] cursor-pointer transition-all"
                data-page="pages/profile.html" data-name="User Profile">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3 min-w-0 flex-1">
                        <div id="pfp"
                            class="w-8 h-8 rounded-[var(--vs-radius)] flex items-center justify-center text-[13px] font-light text-[var(--vs-text-muted)] border border-[var(--vs-border)] bg-[rgba(var(--vs-bg-card-rgb),0.3)] flex-shrink-0">
                            --
                        </div>
                        <div class="min-w-0">
                            <div id="uName"
                                class="text-[13px] font-light text-[var(--vs-text-title)] truncate leading-[1.4]">
                                ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö...
                            </div>
                            <div id="uRole"
                                class="text-[13px] font-light uppercase text-[var(--vs-text-muted)] opacity-[0.45] leading-[1.4]">
                                ‡∏£‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
                            </div>
                        </div>
                    </div>
                    <button id="logoutBtn"
                        class="p-2 hover:bg-[var(--vs-bg-main)] rounded-[var(--vs-radius)] transition-colors group flex-shrink-0"
                        title="Logout" onclick="
                                logout();
                                event.stopPropagation();
                            ">
                        <i
                            class="icon i-logout h-4 w-4 text-[var(--vs-text-muted)] group-hover:text-[var(--vs-danger)]"></i>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content Canvas (CSS Grid: 2-column layout) -->
        <main class="vs-content bg-[var(--vs-bg-main)]"
            style="display:grid;grid-template-columns:1fr;grid-template-rows:48px 1fr auto;">

            <!-- Universal Header -->
            <header
                class="bg-[var(--vs-bg-main)] border-b border-[var(--vs-border)] flex items-center justify-between px-6"
                style="grid-column:1;grid-row:1;">
                <div class="flex items-center gap-1.5 Thai-Rule">
                    <span class="text-[var(--vs-text-muted)] uppercase text-[13px] font-light">‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö</span>
                    <span class="text-[var(--vs-text-muted)]">/</span>
                    <span id="header-page-name"
                        class="text-[var(--vs-text-title)] font-light text-[13px]">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</span>
                </div>

                <div class="flex items-center gap-3">
                    <!-- Global Submit Work Button (Hidden by default, shown when active mission exists) -->
                    <button id="btn-submit-mission" onclick="submitActiveMission()" style="display:none;align-items:center;gap:6px;padding:4px 12px;border-radius:3px;
                            font-size:13px;font-weight:300;cursor:pointer;transition:all 0.2s;
                            background:var(--vs-success);color:white;
                            border:1px solid rgba(16,185,129,0.5);"
                        class="hover:opacity-90 active:scale-95 shadow-[0_0_10px_rgba(16,185,129,0.2)]">
                        <i class="icon i-check" style="width:14px;height:14px;"></i>
                        <span class="Thai-Rule tracking-wide">‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô (Submit)</span>
                    </button>

                    <button id="deleg-toggle-btn" onclick="toggleDelegation()" style="display:none;align-items:center;gap:6px;padding:4px 12px;border-radius:3px;
                            font-size:13px;font-weight:300;cursor:pointer;transition:all 0.2s;
                            background:rgba(34,211,238,0.1);color:var(--vs-accent);
                            border:1px solid rgba(34,211,238,0.3);">
                        <i class="icon i-command-line" style="width:14px;height:14px;"></i>
                        <span class="Thai-Rule">‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
                    </button>
                </div>
            </header>

            <!-- Content Area -->
            <div class="vs-iframe-container" style="grid-column:1;grid-row:2;overflow:hidden;">
                <iframe id="main-frame" src="pages/home.html" title="Workspace Content"></iframe>
            </div>

            <!-- Delegation Sidebar (full-height right column) -->
            <aside id="delegation-sidebar" style="grid-column:2;grid-row:1/-1;
                       width:320px;display:none;flex-direction:column;
                       background:var(--vs-bg-panel);
                       border-left:1px solid var(--vs-border);
                       overflow:hidden;">
                <!-- Rendered by DelegationPanel.render() -->
            </aside>

            <!-- Status Bar -->
            <div id="vs-status-bar" style="grid-column:1;grid-row:3;"
                class="h-6 bg-[var(--vs-bg-main)] border-t border-[var(--vs-border)] flex items-center justify-between px-6 text-[13px] uppercase text-[var(--vs-text-muted)] font-light">
                <div class="flex items-center space-x-4">
                    <div id="status-connection" class="flex items-center gap-1.5">
                        <div class="w-2 h-2 rounded-[var(--vs-radius)] bg-zinc-600 transition-colors"></div>
                        <span class="font-light Thai-Rule">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
                    </div>
                    <span class="font-light">UTF-8</span>
                    <span class="font-light Thai-Rule">‡πÅ‡∏ö‡∏ö‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì</span>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="font-light" style="
                                color: rgba(var(--vs-text-muted-rgb, 113, 113, 122), 0.5);
                            ">E-OS.HUD.V1</span>
                    <div id="status-role-badge" class="flex items-center gap-1.5"
                        style="color: rgba(var(--vs-text-muted-rgb, 113, 113, 122), 0.5)">
                        <i class="icon i-user h-3 w-3"></i>
                        <span class="font-light Thai-Rule text-[13px]">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="vs-toast-container"></div>

    <!-- üõ°Ô∏è FORCE PASSWORD RESET MODAL (Vuln 4 Mitigation) -->
    <div id="force-password-modal" style="display:none;"
        class="fixed inset-0 z-[9999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4">
        <div
            class="bg-[var(--vs-bg-panel)] w-full max-w-md border border-rose-500/50 rounded-[var(--vs-radius)] overflow-hidden shadow-[0_0_40px_rgba(244,63,94,0.15)] flex flex-col">
            <div class="h-1 bg-gradient-to-r from-rose-500 to-orange-500 w-full"></div>
            <div class="p-6 flex flex-col items-center text-center">
                <div
                    class="w-16 h-16 rounded-full bg-rose-500/10 flex items-center justify-center mb-4 border border-rose-500/20">
                    <i class="icon i-shield-exclamation text-rose-500 w-8 h-8"></i>
                </div>
                <h2 class="text-xl font-medium text-white Thai-Rule mb-2">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h2>
                <p class="text-[14px] text-[var(--vs-text-muted)] leading-relaxed mb-6">
                    ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô <strong class="text-rose-400">password123</strong><br>
                    ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö E-OS ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                </p>
                <div class="w-full text-left bg-black/40 p-4 rounded border border-[var(--vs-border)] mb-6">
                    <p
                        class="text-[12px] text-[var(--vs-text-muted)] mb-3 Thai-Rule opacity-80 uppercase tracking-widest text-center">
                        <i class="icon i-information-circle w-3 h-3 inline-block -mt-1 mr-1"></i>
                        ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß (Simulation)
                    </p>
                    <div class="flex items-center gap-2">
                        <input type="password" id="new-password-input"
                            placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£"
                            class="flex-1 bg-black/50 border border-[var(--vs-border)] rounded px-3 py-2 text-sm text-white focus:outline-none focus:border-rose-500 transition-colors">
                    </div>
                </div>
                <button id="btn-force-password"
                    class="w-full bg-rose-600 hover:bg-rose-500 text-white font-medium py-3 rounded transition-colors flex items-center justify-center gap-2 Thai-Rule">
                    <i class="icon i-check w-5 h-5"></i>
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>
            </div>
        </div>
    </div>
    <script src="assets/js/components/tooltip.js?v=2.2"></script>
    <script src="assets/js/notifications.js?v=2.5"></script>
    <script src="assets/js/submenu.js?v=2.4"></script>
    <script src="assets/js/timeline_menu.js?v=3.1"></script>
    <script src="assets/js/explorer.js?v=2.4"></script>
    <script src="assets/js/chat.js?v=2.4"></script>
    <script src="assets/js/management.js?v=3.2"></script>
    <script>
        window.switchView = function (view, subId = null) {
            const activityItem = document.querySelector(
                `.activity-item[data-view="${view}"]`,
            );
            if (activityItem) {
                activityItem.click();
                if (view === "chat" && subId && window.ChatEngine) {
                    setTimeout(
                        () => window.ChatEngine.openChat(subId),
                        100,
                    );
                }
                // Timeline menus now rendered by ManagementEngine.renderDashboard()
            }

            // SECURITY/UX ISOLATION: 
            // The Delegation Panel MUST NOT bleed into other Explorers or Chat.
            // Force hide if navigating away from Mission Control ('manage').
            const delegSidebar = document.getElementById('delegation-sidebar');
            const btnSubmitMission = document.getElementById('btn-submit-mission');
            const delegToggleBtn = document.getElementById('deleg-toggle-btn');

            if (view !== 'manage') {
                if (delegSidebar) delegSidebar.style.display = 'none';
                if (btnSubmitMission) btnSubmitMission.style.display = 'none';
                if (delegToggleBtn) delegToggleBtn.style.display = 'none';
            } else {
                if (delegToggleBtn) delegToggleBtn.style.display = 'flex';
            }
        };
    </script>
</body>

</html>