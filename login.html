<!doctype html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login | IDLPMS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="assets/css/theme.css?v=2.4" />
    <link rel="stylesheet" href="assets/css/styles.css?v=2.4" />
    <script src="assets/js/data.js?v=2.4"></script>
    <script src="src/services/DataService.js?v=2.4"></script>
    <script src="src/services/AuthService.js?v=2.4"></script>
    <script src="src/services/AppBootstrap.js?v=2.4"></script>
</head>

<body
    class="vs-login-container text-[var(--vs-text-body)] overflow-y-auto font-['Sarabun'] antialiased select-none min-h-screen">
    <!-- Background Decoration -->
    <div class="fixed inset-0 pointer-events-none">
        <div class="vs-bg-ornament top-[5%] left-[5%] w-[20%] h-[20%] border-t border-l"></div>
        <div class="vs-bg-ornament bottom-[5%] right-[5%] w-[20%] h-[20%] border-b border-r"></div>
        <div class="absolute top-1/2 left-0 w-full h-px bg-[var(--vs-border)] opacity-10"></div>
    </div>

    <div class="relative z-10 flex flex-col items-center justify-center p-6 min-h-screen">
        <!-- Logo/Header -->
        <div class="mb-12 text-center">
            <div class="w-16 h-16 vs-login-card vs-logo-glow flex items-center justify-center mx-auto mb-6">
                <i class="icon i-academic h-8 w-8 text-[var(--vs-accent)]"></i>
            </div>
            <h1 class="text-3xl font-extralight text-[var(--vs-text-title)]">
                IDLPMS <span class="font-normal text-[var(--vs-accent)]">HUD</span>
            </h1>
            <div class="vs-divider-text max-w-[300px] mx-auto opacity-60">
                <div class="vs-divider-line"></div>
                <p class="vs-divider-label">Unified Education Command Center</p>
                <div class="vs-divider-line"></div>
            </div>
        </div>

        <!-- Login Card -->
        <div class="w-full max-w-[400px] p-8 vs-login-card rounded-[var(--vs-radius)]">
            <form class="space-y-6" onsubmit="return handleLogin(event);">
                <div class="space-y-2">
                    <label class="vs-divider-label block px-1">Access Identity</label>
                    <div class="vs-login-input-group">
                        <i
                            class="icon i-user h-4 w-4 absolute left-4 top-1/2 -translate-y-1/2 text-[var(--vs-text-muted)] group-focus-within:text-[var(--vs-accent)] transition-colors"></i>
                        <input type="text" id="authId" placeholder="IDENTITY_AUTH_ID" class="vs-login-input" />
                    </div>
                </div>
                <div class="space-y-2">
                    <label class="vs-divider-label block px-1">Security Key</label>
                    <div class="vs-login-input-group">
                        <i
                            class="icon i-lock h-4 w-4 absolute left-4 top-1/2 -translate-y-1/2 text-[var(--vs-text-muted)] group-focus-within:text-[var(--vs-accent)] transition-colors"></i>
                        <input type="password" id="secKey" placeholder="รหัสผ่านความปลอดภัย"
                            class="vs-login-input Thai-Rule" />
                    </div>
                </div>
                <button type="submit"
                    class="w-full bg-[var(--vs-accent)] text-zinc-900 text-sm font-extralight py-3.5 rounded-[var(--vs-radius)] hover:brightness-110 transition-all active:scale-[0.98] uppercase Thai-Rule">
                    พิสูจน์ตัวตนเข้าใช้งานระบบ
                </button>
            </form>

            <div class="vs-login-footer">
                <a href="#" class="hover:text-[var(--vs-accent)] transition-colors">Credential Recovery</a>
                <div class="vs-identity-badge">Node: Localhost_3333</div>
            </div>
        </div>

        <!-- Persona Selection Grid -->
        <div class="mt-16 w-full max-w-5xl px-4 animate-in fade-in slide-in-from-bottom-4 duration-1000">
            <div class="vs-divider-text mb-8">
                <div class="vs-divider-line"></div>
                <span class="vs-divider-label">Identify Persona Access</span>
                <div class="vs-divider-line"></div>
            </div>

            <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-4">
                <!-- Administrative Personas -->
                <button onclick="quickSelect('STU_001')" class="vs-persona-card group">
                    <div class="vs-persona-icon-container">
                        <i
                            class="icon i-user h-5 w-5 text-[var(--id-stu)] opacity-40 group-hover:opacity-100 transition-opacity"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] font-extralight">Student</span>
                </button>

                <button onclick="quickSelect('PAR_HS_001')" class="vs-persona-card group">
                    <div class="vs-persona-icon-container">
                        <i
                            class="icon i-users h-5 w-5 text-[var(--id-parent)] opacity-40 group-hover:opacity-100 transition-opacity"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] font-extralight">Parent</span>
                </button>

                <button onclick="quickSelect('TEA_020')" class="vs-persona-card group">
                    <div class="vs-persona-icon-container">
                        <i
                            class="icon i-academic h-5 w-5 text-[var(--vs-accent)] opacity-40 group-hover:opacity-100 transition-opacity"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] font-extralight">Teacher</span>
                </button>

                <button onclick="quickSelect('SCH_DIR_001')" class="vs-persona-card group">
                    <div class="vs-persona-icon-container">
                        <i
                            class="icon i-office h-5 w-5 text-[var(--id-dir)] opacity-40 group-hover:opacity-100 transition-opacity"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] font-extralight">Director</span>
                </button>

                <button onclick="quickSelect('ESA_DIR_001')" class="vs-persona-card group">
                    <div class="vs-persona-icon-container">
                        <i
                            class="icon i-building h-5 w-5 text-[var(--id-esa)] opacity-40 group-hover:opacity-100 transition-opacity"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] font-extralight">ESA
                        Dir</span>
                </button>

                <button onclick="quickSelect('OBEC_001')" class="vs-persona-card group">
                    <div class="vs-persona-icon-container">
                        <i
                            class="icon i-library h-5 w-5 text-[var(--id-obec)] opacity-40 group-hover:opacity-100 transition-opacity"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] font-extralight">OBEC
                        HQ</span>
                </button>

                <button onclick="quickSelect('MOE_001')" class="vs-persona-card group">
                    <div class="vs-persona-icon-container">
                        <i
                            class="icon i-globe h-5 w-5 text-[var(--id-moe)] opacity-40 group-hover:opacity-100 transition-opacity"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] font-extralight">MOE
                        HQ</span>
                </button>
            </div>

            <!-- Wat Map Chalud — Full School Access -->
            <div class="vs-divider-text my-8">
                <div class="vs-divider-line"></div>
                <span class="vs-divider-label">โรงเรียนวัดมาบชลูด — Quick Access (18 + 1)</span>
                <div class="vs-divider-line"></div>
            </div>

            <!-- Director + 17 Teachers Grid -->
            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 mb-4">
                <button onclick="quickSelect('DIR_MABLUD')"
                    class="vs-persona-card border-yellow-500/20 group hover:border-yellow-500/50 py-3">
                    <div class="vs-persona-icon-container border-yellow-500/10"><i
                            class="icon i-office h-4 w-4 text-yellow-500/50 group-hover:text-yellow-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-yellow-500 Thai-Rule font-extralight">ผอ.วรชัย<br><span
                            class="opacity-50">ผู้อำนวยการ</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_01')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูสายบัว<br><span
                            class="opacity-50">ป.1/1</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_02')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูเก่งกาจ<br><span
                            class="opacity-50">ป.1/2</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_03')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูวิชิต<br><span
                            class="opacity-50">ป.2/1</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_04')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูมานี<br><span
                            class="opacity-50">ป.2/2</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_05')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูอารี<br><span
                            class="opacity-50">ป.3/1</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_06')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูปราณี<br><span
                            class="opacity-50">ป.3/2</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_07')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูธงไชย<br><span
                            class="opacity-50">ป.4/1</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_08')"
                    class="vs-persona-card border-teal-500/20 group hover:border-teal-500/50 py-3">
                    <div class="vs-persona-icon-container border-teal-500/10"><i
                            class="icon i-academic h-4 w-4 text-teal-500/50 group-hover:text-teal-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-teal-500 Thai-Rule font-extralight">ครูนารี<br><span
                            class="opacity-50">สังคม</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_09')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูสมชาย<br><span
                            class="opacity-50">ป.5/1</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_10')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูสมหญิง<br><span
                            class="opacity-50">ป.5/2</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_11')"
                    class="vs-persona-card border-emerald-500/20 group hover:border-emerald-500/50 py-3">
                    <div class="vs-persona-icon-container border-emerald-500/10"><i
                            class="icon i-academic h-4 w-4 text-emerald-500/50 group-hover:text-emerald-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-emerald-500 Thai-Rule font-extralight">ครูวิไล<br><span
                            class="opacity-50">ป.6/1</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_12')"
                    class="vs-persona-card border-teal-500/20 group hover:border-teal-500/50 py-3">
                    <div class="vs-persona-icon-container border-teal-500/10"><i
                            class="icon i-academic h-4 w-4 text-teal-500/50 group-hover:text-teal-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-teal-500 Thai-Rule font-extralight">ครูสมพร<br><span
                            class="opacity-50">สังคม</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_13')"
                    class="vs-persona-card border-teal-500/20 group hover:border-teal-500/50 py-3">
                    <div class="vs-persona-icon-container border-teal-500/10"><i
                            class="icon i-academic h-4 w-4 text-teal-500/50 group-hover:text-teal-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-teal-500 Thai-Rule font-extralight">ครูประภา<br><span
                            class="opacity-50">พลศึกษา</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_14')"
                    class="vs-persona-card border-teal-500/20 group hover:border-teal-500/50 py-3">
                    <div class="vs-persona-icon-container border-teal-500/10"><i
                            class="icon i-academic h-4 w-4 text-teal-500/50 group-hover:text-teal-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-teal-500 Thai-Rule font-extralight">ครูจรูญ<br><span
                            class="opacity-50">ศิลปะ</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_15')"
                    class="vs-persona-card border-teal-500/20 group hover:border-teal-500/50 py-3">
                    <div class="vs-persona-icon-container border-teal-500/10"><i
                            class="icon i-academic h-4 w-4 text-teal-500/50 group-hover:text-teal-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-teal-500 Thai-Rule font-extralight">ครูอำไพ<br><span
                            class="opacity-50">อังกฤษ</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_16')"
                    class="vs-persona-card border-teal-500/20 group hover:border-teal-500/50 py-3">
                    <div class="vs-persona-icon-container border-teal-500/10"><i
                            class="icon i-academic h-4 w-4 text-teal-500/50 group-hover:text-teal-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-teal-500 Thai-Rule font-extralight">ครูยอดชาย<br><span
                            class="opacity-50">สังคม</span></span>
                </button>
                <button onclick="quickSelect('TEA_M_17')"
                    class="vs-persona-card border-teal-500/20 group hover:border-teal-500/50 py-3">
                    <div class="vs-persona-icon-container border-teal-500/10"><i
                            class="icon i-academic h-4 w-4 text-teal-500/50 group-hover:text-teal-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-teal-500 Thai-Rule font-extralight">ครูบุญรอด<br><span
                            class="opacity-50">การงาน</span></span>
                </button>
            </div>

            <!-- Student -->
            <div class="grid grid-cols-1 gap-3">
                <button onclick="quickSelect('STU_M_001')"
                    class="vs-persona-card border-sky-500/20 group hover:border-sky-500/50 flex-row gap-3 py-3">
                    <div class="vs-persona-icon-container border-sky-500/10 shrink-0">
                        <i class="icon i-user h-5 w-5 text-sky-500/50 group-hover:text-sky-500 transition-colors"></i>
                    </div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-sky-500 Thai-Rule font-extralight">น้องดา
                        มีใจ — นักเรียน ป.1/1</span>
                </button>
            </div>
        </div>

        <!-- Grade Level Quick Access -->
        <div class="mt-8 w-full max-w-5xl px-4 animate-in fade-in slide-in-from-bottom-4 duration-1000">
            <div class="vs-divider-text mb-6">
                <div class="vs-divider-line"></div>
                <span class="vs-divider-label">Quick Student Access (ป.1-6)</span>
                <div class="vs-divider-line"></div>
            </div>

            <div class="grid grid-cols-3 sm:grid-cols-6 gap-3">
                <button onclick="quickSelect('STU_G1')" class="vs-persona-card py-4 group">
                    <div
                        class="w-8 h-8 rounded-[3px] vs-login-card flex items-center justify-center text-sm font-extralight text-[var(--vs-accent)]">
                        1</div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] Thai-Rule font-extralight">ป.1</span>
                </button>
                <button onclick="quickSelect('STU_G2')" class="vs-persona-card py-4 group">
                    <div
                        class="w-8 h-8 rounded-[3px] vs-login-card flex items-center justify-center text-sm font-extralight text-[var(--vs-accent)]">
                        2</div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] Thai-Rule font-extralight">ป.2</span>
                </button>
                <button onclick="quickSelect('STU_G3')" class="vs-persona-card py-4 group">
                    <div
                        class="w-8 h-8 rounded-[3px] vs-login-card flex items-center justify-center text-sm font-extralight text-[var(--vs-accent)]">
                        3</div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] Thai-Rule font-extralight">ป.3</span>
                </button>
                <button onclick="quickSelect('STU_G4')" class="vs-persona-card py-4 group">
                    <div
                        class="w-8 h-8 rounded-[3px] vs-login-card flex items-center justify-center text-sm font-extralight text-[var(--vs-accent)]">
                        4</div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] Thai-Rule font-extralight">ป.4</span>
                </button>
                <button onclick="quickSelect('STU_G5')" class="vs-persona-card py-4 group">
                    <div
                        class="w-8 h-8 rounded-[3px] vs-login-card flex items-center justify-center text-sm font-extralight text-[var(--vs-accent)]">
                        5</div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] Thai-Rule font-extralight">ป.5</span>
                </button>
                <button onclick="quickSelect('STU_G6')" class="vs-persona-card py-4 group">
                    <div
                        class="w-8 h-8 rounded-[3px] vs-login-card flex items-center justify-center text-sm font-extralight text-[var(--vs-accent)]">
                        6</div>
                    <span
                        class="text-sm text-[var(--vs-text-muted)] group-hover:text-[var(--vs-text-title)] Thai-Rule font-extralight">ป.6</span>
                </button>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-16 text-center opacity-40">
            <p class="text-sm font-extralight uppercase text-[var(--vs-text-muted)]">
                IDLPMS v2.0 • Unified Protocol • Confidential Property of MOE
            </p>
        </footer>
    </div>

    <script>
        // Initialize Services
        document.addEventListener('DOMContentLoaded', () => {
            AppBootstrap.getInstance().init().catch(err => {
                console.error('Core system failure:', err);
            });
        });

        async function quickSelect(userId) {
            try {
                const app = AppBootstrap.getInstance();
                if (!app.isReady) await app.init();

                await app.auth.login(userId);
                window.location.href = 'hud.html';
            } catch (err) {
                alert('การพิสูจน์ตัวตนล้มเหลว: ' + err.message);
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            const authId = document.getElementById('authId').value.trim();
            const secKey = document.getElementById('secKey').value;

            try {
                const app = AppBootstrap.getInstance();
                if (!app.isReady) await app.init();

                // Simple check for demo security key if needed
                // But generally we use the AuthService
                await app.auth.login(authId, secKey);
                window.location.href = 'hud.html';
            } catch (err) {
                if (err.code === 'USER_NOT_FOUND' && secKey) {
                    // Fallback for MOE access if special key used
                    localStorage.setItem('idlpms_active_user_id', 'MOE_001');
                    window.location.href = 'hud.html';
                } else {
                    alert('การพิสูจน์ตัวตนล้มเหลว: ' + err.message);
                }
            }
            return false;
        }
    </script>
</body>

</html>